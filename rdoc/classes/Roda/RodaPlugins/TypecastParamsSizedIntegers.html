<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01//EN" "http://www.w3.org/TR/html4/strict.dtd">
<html lang='en'>
<head>
<title>Roda::RodaPlugins::TypecastParamsSizedIntegers</title>
<meta name='viewport' content='width=device-width, initial-scale=1'>
<meta content='text/html; charset=UTF-8' http-equiv='Content-Type'>
<link href='../../../css/style.css' media='screen' rel='stylesheet' type='text/css'>
<script type='text/javascript'>
  function popupCode(url) {
    window.open(url, "Code", "resizable=yes,scrollbars=yes,toolbar=no,status=no,height=150,width=400")
  }
  
  function toggleCode(id) {
    var code = document.getElementById(id)
  
    code.style.display = code.style.display != 'block' ? 'block' : 'none'
    return true
  }
  
  // Make codeblocks hidden by default
  document.writeln('<' + 'style type="text/css">.method .source pre { display: none }<\/style>')
</script>
</head>
<body class='page'>
<div class='class' id='wrapper'>
<div class='header'>
<h1 class='name'><span class='type'>module</span>
Roda::RodaPlugins::TypecastParamsSizedIntegers
</h1>
<ol class='paths'>
<li>
<a href="../../../files/lib/roda/plugins/typecast_params_sized_integers_rb.html">lib/roda/plugins/typecast_params_sized_integers.rb</a>
</li>
</ol>
</div>
<div id='content'>
<div id='text'>
<div id='description'>
<p>The typecast_params_sized_integers plugin adds sized integer conversion methods to typecast_params:</p>
<ul><li>
<p>int8, uint8, pos_int8, pos_uint8, Integer8, Integeru8</p>
</li><li>
<p>int16, uint16, pos_int16, pos_uint16, Integer16, Integeru16</p>
</li><li>
<p>int32, uint32, pos_int32, pos_uint32, Integer32, Integeru32</p>
</li><li>
<p>int64, uint64, pos_int64, pos_uint64, Integer64, Integeru64</p>
</li></ul>

<p>The int*, pos_int*, and Integer* methods operate the same as the standard int, pos_int, and Integer methods in typecast_params, except that they will only handle parameter values in the given range for the signed integer type.  The uint*, pos_int*, and Integeru* methods are similar to the int*, pos_int*, and Integer* methods, except they use the range of the unsigned integer type instead of the range of the signed integer type.</p>

<p>Here are the signed and unsigned integer type ranges:</p>
<table class="rdoc-list note-list"><tbody><tr><td class='label'>8 </td><td><table class="rdoc-list label-list"><tbody><tr><td class='label'>-128, 127], [0, 255</td><td></td></tr></tbody></table>
</td></tr><tr><td class='label'>16 </td><td><table class="rdoc-list label-list"><tbody><tr><td class='label'>-32768, 32767], [0, 65535</td><td></td></tr></tbody></table>
</td></tr><tr><td class='label'>32 </td><td><table class="rdoc-list label-list"><tbody><tr><td class='label'>-2147483648, 2147483647], [0, 4294967295</td><td></td></tr></tbody></table>
</td></tr><tr><td class='label'>64 </td><td><table class="rdoc-list label-list"><tbody><tr><td class='label'>-9223372036854775808, 9223372036854775807], [0, 18446744073709551615</td><td></td></tr></tbody></table>
</td></tr></tbody></table>

<p>To only create methods for certain integer sizes, you can pass a :sizes option when loading the plugin, and it will only create methods for the sizes you specify.</p>

<p>You can provide a :default_size option when loading the plugin, in which case the int, uint, pos_int, pos_uint, Integer, and Integeru, typecast_params conversion methods will be aliases to the conversion methods for the given sized type:</p>

<pre class="ruby"><span class="ruby-identifier">plugin</span> <span class="ruby-value">:typecast_params_sized_integers</span>, <span class="ruby-value">default_size:</span> <span class="ruby-value">64</span>

<span class="ruby-identifier">route</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">r</span><span class="ruby-operator">|</span>
  <span class="ruby-comment"># Returns nil unless param.to_i &gt; 0 &amp;&amp; param.to_i &lt;= 9223372036854775807</span>
  <span class="ruby-identifier">typecast_params</span>.<span class="ruby-identifier">pos_int</span>(<span class="ruby-string">&#39;param_name&#39;</span>)
<span class="ruby-keyword">end</span>
</pre>
</div>
<div id='method-list'>
<h2>Methods</h2>
<h3>Public Class</h3>
<ol>
<li><a href="#method-c-load_dependencies">load_dependencies</a></li>
</ol>
</div>
<div id='context'>
</div>
<div id='section'>
<div id='methods'>
<h2>Public Class methods</h2>
<div class='method public-class' id='method-method-c-load_dependencies'>
<a name='method-c-load_dependencies'></a>
<div class='synopsis'>
<span class='name'>load_dependencies</span><span class='arguments'>(app, opts=OPTS)</span>

</div>
<div class='description'>

</div>
<div class='source'>
<a class='source-toggle' href='#' onclick='toggleCode(&#39;method-c-load_dependencies-source&#39;); return false'>
[show source]
</a>
<pre id='method-c-load_dependencies-source'>    <span class="ruby-comment"># File lib/roda/plugins/typecast_params_sized_integers.rb</span>
<span class="line-num"> 44</span> <span class="ruby-keyword">def</span> <span class="ruby-keyword">self</span>.<span class="ruby-identifier ruby-title">load_dependencies</span>(<span class="ruby-identifier">app</span>, <span class="ruby-identifier">opts</span>=<span class="ruby-constant">OPTS</span>)
<span class="line-num"> 45</span>   <span class="ruby-identifier">app</span>.<span class="ruby-identifier">plugin</span> <span class="ruby-value">:typecast_params</span> <span class="ruby-keyword">do</span>
<span class="line-num"> 46</span>     (<span class="ruby-identifier">opts</span>[<span class="ruby-value">:sizes</span>] <span class="ruby-operator">||</span> [<span class="ruby-value">8</span>, <span class="ruby-value">16</span>, <span class="ruby-value">32</span>, <span class="ruby-value">64</span>]).<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
<span class="line-num"> 47</span>       <span class="ruby-comment"># Avoid defining the same methods more than once</span>
<span class="line-num"> 48</span>       <span class="ruby-keyword">next</span> <span class="ruby-keyword">if</span> <span class="ruby-identifier">method_defined?</span>(<span class="ruby-value">:&quot;pos_int#{i}&quot;</span>)
<span class="line-num"> 49</span> 
<span class="line-num"> 50</span>       <span class="ruby-identifier">min_signed</span> = <span class="ruby-operator">-</span>(<span class="ruby-value">2</span><span class="ruby-operator">**</span>(<span class="ruby-identifier">i</span><span class="ruby-value">-1</span>))
<span class="line-num"> 51</span>       <span class="ruby-identifier">max_signed</span> = <span class="ruby-value">2</span><span class="ruby-operator">**</span>(<span class="ruby-identifier">i</span><span class="ruby-value">-1</span>)<span class="ruby-value">-1</span>
<span class="line-num"> 52</span>       <span class="ruby-identifier">max_unsigned</span> = <span class="ruby-value">2</span><span class="ruby-operator">**</span><span class="ruby-identifier">i</span><span class="ruby-value">-1</span>
<span class="line-num"> 53</span> 
<span class="line-num"> 54</span>       <span class="ruby-identifier">handle_type</span>(<span class="ruby-value">:&quot;int#{i}&quot;</span>, <span class="ruby-value">:max_input_bytesize</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">100</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
<span class="line-num"> 55</span>         <span class="ruby-keyword">if</span> (<span class="ruby-identifier">v</span> = <span class="ruby-identifier">base_convert_int</span>(<span class="ruby-identifier">v</span>)) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">min_signed</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">max_signed</span>
<span class="line-num"> 56</span>           <span class="ruby-identifier">v</span>
<span class="line-num"> 57</span>         <span class="ruby-keyword">end</span>
<span class="line-num"> 58</span>       <span class="ruby-keyword">end</span>
<span class="line-num"> 59</span> 
<span class="line-num"> 60</span>       <span class="ruby-identifier">handle_type</span>(<span class="ruby-value">:&quot;uint#{i}&quot;</span>, <span class="ruby-value">:max_input_bytesize</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">100</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
<span class="line-num"> 61</span>         <span class="ruby-keyword">if</span> (<span class="ruby-identifier">v</span> = <span class="ruby-identifier">base_convert_int</span>(<span class="ruby-identifier">v</span>)) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">max_unsigned</span>
<span class="line-num"> 62</span>           <span class="ruby-identifier">v</span>
<span class="line-num"> 63</span>         <span class="ruby-keyword">end</span>
<span class="line-num"> 64</span>       <span class="ruby-keyword">end</span>
<span class="line-num"> 65</span> 
<span class="line-num"> 66</span>       <span class="ruby-identifier">handle_type</span>(<span class="ruby-value">:&quot;pos_int#{i}&quot;</span>, <span class="ruby-value">:max_input_bytesize</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">100</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
<span class="line-num"> 67</span>         <span class="ruby-keyword">if</span> (<span class="ruby-identifier">v</span> = <span class="ruby-identifier">base_convert_int</span>(<span class="ruby-identifier">v</span>)) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">max_signed</span>
<span class="line-num"> 68</span>           <span class="ruby-identifier">v</span>
<span class="line-num"> 69</span>         <span class="ruby-keyword">end</span>
<span class="line-num"> 70</span>       <span class="ruby-keyword">end</span>
<span class="line-num"> 71</span> 
<span class="line-num"> 72</span>       <span class="ruby-identifier">handle_type</span>(<span class="ruby-value">:&quot;pos_uint#{i}&quot;</span>, <span class="ruby-value">:max_input_bytesize</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">100</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
<span class="line-num"> 73</span>         <span class="ruby-keyword">if</span> (<span class="ruby-identifier">v</span> = <span class="ruby-identifier">base_convert_int</span>(<span class="ruby-identifier">v</span>)) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">max_unsigned</span>
<span class="line-num"> 74</span>           <span class="ruby-identifier">v</span>
<span class="line-num"> 75</span>         <span class="ruby-keyword">end</span>
<span class="line-num"> 76</span>       <span class="ruby-keyword">end</span>
<span class="line-num"> 77</span> 
<span class="line-num"> 78</span>       <span class="ruby-identifier">handle_type</span>(<span class="ruby-value">:&quot;Integer#{i}&quot;</span>, <span class="ruby-value">:max_input_bytesize</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">100</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
<span class="line-num"> 79</span>         <span class="ruby-keyword">if</span> (<span class="ruby-identifier">v</span> = <span class="ruby-identifier">base_convert_Integer</span>(<span class="ruby-identifier">v</span>)) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">min_signed</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">max_signed</span>
<span class="line-num"> 80</span>           <span class="ruby-identifier">v</span>
<span class="line-num"> 81</span>         <span class="ruby-keyword">end</span>
<span class="line-num"> 82</span>       <span class="ruby-keyword">end</span>
<span class="line-num"> 83</span> 
<span class="line-num"> 84</span>       <span class="ruby-identifier">handle_type</span>(<span class="ruby-value">:&quot;Integeru#{i}&quot;</span>, <span class="ruby-value">:max_input_bytesize</span><span class="ruby-operator">=&gt;</span><span class="ruby-value">100</span>) <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
<span class="line-num"> 85</span>         <span class="ruby-keyword">if</span> (<span class="ruby-identifier">v</span> = <span class="ruby-identifier">base_convert_Integer</span>(<span class="ruby-identifier">v</span>)) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-value">0</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">v</span> <span class="ruby-operator">&lt;=</span> <span class="ruby-identifier">max_unsigned</span>
<span class="line-num"> 86</span>           <span class="ruby-identifier">v</span>
<span class="line-num"> 87</span>         <span class="ruby-keyword">end</span>
<span class="line-num"> 88</span>       <span class="ruby-keyword">end</span>
<span class="line-num"> 89</span>     <span class="ruby-keyword">end</span>
<span class="line-num"> 90</span>   <span class="ruby-keyword">end</span>
<span class="line-num"> 91</span> 
<span class="line-num"> 92</span>   <span class="ruby-keyword">if</span> <span class="ruby-identifier">default</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:default_size</span>]
<span class="line-num"> 93</span>     <span class="ruby-identifier">app</span><span class="ruby-operator">::</span><span class="ruby-constant">TypecastParams</span>.<span class="ruby-identifier">class_eval</span> <span class="ruby-keyword">do</span>
<span class="line-num"> 94</span>       <span class="ruby-node">%w[int uint pos_int pos_uint Integer Integeru]</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">type</span><span class="ruby-operator">|</span>
<span class="line-num"> 95</span>         [<span class="ruby-string">&#39;&#39;</span>, <span class="ruby-string">&#39;convert_&#39;</span>, <span class="ruby-string">&#39;_convert_array_&#39;</span>, <span class="ruby-string">&#39;_max_input_bytesize_for_&#39;</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">prefix</span><span class="ruby-operator">|</span>
<span class="line-num"> 96</span>           <span class="ruby-identifier">alias_method</span> <span class="ruby-value">:&quot;#{prefix}#{type}&quot;</span>, <span class="ruby-value">:&quot;#{prefix}#{type}#{default}&quot;</span>
<span class="line-num"> 97</span>         <span class="ruby-keyword">end</span>
<span class="line-num"> 98</span>         <span class="ruby-identifier">alias_method</span> <span class="ruby-value">:&quot;#{type}!&quot;</span>, <span class="ruby-value">:&quot;#{type}#{default}!&quot;</span>
<span class="line-num"> 99</span>       <span class="ruby-keyword">end</span>
<span class="line-num">100</span>     <span class="ruby-keyword">end</span>
<span class="line-num">101</span>   <span class="ruby-keyword">end</span>
<span class="line-num">102</span> <span class="ruby-keyword">end</span></pre>
</div>
</div>
</div>
</div>

</div>
</div>

<div id='footer-push'></div>
</div>
<div id='footer'>
<a href="https://github.com/jeremyevans/hanna-nouveau"><strong>Hanna Nouveau</strong> RDoc template</a>
</div>
</body>
</html>
